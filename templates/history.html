<div class="card">
    <div class="card-header">
        <h2><i class="fas fa-history"></i> История анализов</h2>
        <div>
            <span class="btn btn-secondary" onclick="clearHistory()">
                <i class="fas fa-trash"></i> Очистить историю
            </span>
        </div>
    </div>
    
    {% if history %}
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Дата</th>
                    <th>Тип анализа</th>
                    <th>Результат</th>
                    <th>Вероятность</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for item in history %}
                <tr>
                    <td>{{ item.date }}</td>
                    <td>{{ item.type }}</td>
                    <td>
                        {% if item.result %}
                            {{ item.result.disease }}
                        {% elif item.results %}
                            {% for type, result in item.results.items() %}
                                {{ type }}: {{ result.disease }}<br>
                            {% endfor %}
                        {% endif %}
                    </td>
                    <td>
                        {% if item.result %}
                            <span class="confidence-badge">{{ item.result.confidence }}</span>
                        {% elif item.results %}
                            {% for type, result in item.results.items() %}
                                <span class="confidence-badge">{{ result.confidence }}</span><br>
                            {% endfor %}
                        {% endif %}
                    </td>
                    <td>
                        <button class="btn btn-secondary" onclick="downloadReport('{{ item.id }}')">
                            <i class="fas fa-download"></i> Отчет
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 3rem; color: var(--text-light);">
        <i class="fas fa-history" style="font-size: 4rem; margin-bottom: 1rem;"></i>
        <h3>История анализов пуста</h3>
        <p>Пройдите первый анализ, чтобы увидеть его здесь</p>
        <a href="/scan" class="btn btn-primary" style="margin-top: 1rem;">
            <i class="fas fa-camera"></i> Начать сканирование
        </a>
    </div>
    {% endif %}
</div>

<script>
function clearHistory() {
    if (confirm('Очистить всю историю анализов?')) {
        // Здесь должен быть запрос к серверу для очистки истории
        alert('История очищена');
        location.reload();
    }
}
</script>